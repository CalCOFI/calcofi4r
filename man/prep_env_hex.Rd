% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{prep_env_hex}
\alias{prep_env_hex}
\title{Aggregate Environmental Data into H3 Hexagons}
\usage{
prep_env_hex(df_env, res_range, env_stat)
}
\arguments{
\item{df_env}{dbplyr lazy table with H3 index columns (\code{hex_h3res*}) and \code{qty} column}

\item{res_range}{Integer vector of H3 resolution levels to generate (e.g., 3:5)}

\item{env_stat}{Character string specifying aggregation function: "mean", "median", "min", "max", "sd"}
}
\value{
List of sf objects, one per resolution level, each with columns:
\itemize{
\item \code{resolution} - H3 resolution level
\item \code{hexid} - H3 hexagon identifier
\item \code{env.value} - aggregated environmental value
\item \code{tooltip} - rounded value for display
\item \code{geometry} - sf geometry (hexagon polygon)
}
}
\description{
Converts environmental point data into multi-resolution H3 hexagonal bins
with aggregated statistics and geometries for mapping. Uses dbplyr lazy
evaluation to defer collection until after aggregation.
}
\details{
This function uses dbplyr lazy evaluation to efficiently aggregate data
across multiple H3 resolutions via \code{union_all}. Geometries are joined
from a pre-computed sf object (\code{sf_hex}).
}
\examples{
\dontrun{
df_env <- get_env("t_deg_c", qtr = 1:4, date_range = c("2000-01-01", "2020-12-31"), min_depth = 0, max_depth = 100)
env_hex <- prep_env_hex(df_env, res_range = 3:5, env_stat = "mean")
}

}
\seealso{
\code{\link{map_env}} for visualization

\code{\link{get_env}} for data retrieval
}
\concept{analyze}
