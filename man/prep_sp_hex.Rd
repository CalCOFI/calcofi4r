% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{prep_sp_hex}
\alias{prep_sp_hex}
\title{Aggregate Species Data into H3 Hexagons}
\usage{
prep_sp_hex(df_sp, res_range)
}
\arguments{
\item{df_sp}{dbplyr lazy table with columns: \code{hex_h3res*}, \code{std_tally}}

\item{res_range}{Integer vector of H3 resolution levels to generate (e.g., 3:5)}
}
\value{
List of sf objects, one per resolution level, each with columns:
\itemize{
\item \code{resolution} - H3 resolution level
\item \code{hexid} - H3 hexagon identifier
\item \code{sp.value} - mean standardized tally
\item \code{tooltip} - rounded value for display
\item \code{geometry} - sf geometry (hexagon polygon)
}
}
\description{
Converts species occurrence/abundance data into multi-resolution H3 hexagonal
bins with aggregated statistics and geometries for mapping.
}
\details{
This function uses dbplyr lazy evaluation to efficiently aggregate data
across multiple H3 resolutions via \code{union_all}. Geometries are joined
from a pre-computed sf object (\code{sf_hex}).
}
\examples{
\dontrun{
df_sp <- get_sp("Anchovy (Engraulis mordax)", qtr = 1:4, date_range = c("2000-01-01", "2020-12-31"))
sp_hex <- prep_sp_hex(df_sp, res_range = 3:5)
}

}
\seealso{
\code{\link{map_sp}} for visualization

\code{\link{get_sp}} for data retrieval
}
