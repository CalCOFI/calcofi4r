% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions.R
\name{prep_ts_env}
\alias{prep_ts_env}
\title{Build Environmental Time Series Data}
\usage{
prep_ts_env(df_env, ts_res)
}
\arguments{
\item{df_env}{dbplyr lazy table with columns: \code{dtime}, \code{qty}}

\item{ts_res}{Character string specifying temporal resolution: "year", "quarter",
"month", "day", "year_quarter", "year_month", or "year_day"}
}
\value{
data.frame with columns:
\itemize{
\item \code{time} - aggregated time value
\item \code{avg} - mean of \code{qty}
\item \code{std} - standard error of \code{qty} (sd/n)
\item \code{upr} - upper confidence bound (avg + std)
\item \code{lwr} - lower confidence bound (avg - std)
}
}
\description{
Aggregates environmental data by temporal resolution, computing mean and
standard error for visualization in time series plots. Uses dbplyr lazy
evaluation for efficient database queries.
}
\details{
For seasonal plots (\code{ts_res = "quarter"}), the function adds a wrapping
row to ensure visual continuity across the year boundary. Data is collected
from database only at the end of aggregation.
}
\examples{
\dontrun{
df_env <- get_env("t_deg_c", qtr = 1:4, date_range = c("2000-01-01", "2020-12-31"), min_depth = 0, max_depth = 100)
env_ts <- prep_ts_env(df_env, ts_res = "year")
}

}
\seealso{
\code{\link{expr_time_env}} for temporal transformation logic

\code{\link{plot_ts}} for visualization
}
